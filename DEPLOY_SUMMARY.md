# –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é Company Canvas

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

**–ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é:**
‚úÖ Dockerfile –∞–∫—Ç—É–∞–ª–µ–Ω
‚úÖ Requirements.txt –ø—Ä–æ–≤–µ—Ä–µ–Ω  
‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ (v08g+)
‚úÖ sessions_metadata.json –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Å–∫—Ä–∏–ø—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ù–∞ Windows (–ª–æ–∫–∞–ª—å–Ω–æ):

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker Desktop** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ:**
   ```powershell
   .\deploy.ps1
   ```

3. **–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:**
   ```bash
   docker build -t company-canvas-app .
   docker tag company-canvas-app sergeykostichev/company-canvas-app:v08h
   docker push sergeykostichev/company-canvas-app:v08h
   ```

### –ù–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–í–ê–ñ–ù–û!):**
   ```bash
   sudo mkdir -p /srv/company-canvas/output
   sudo chown -R $USER:$USER /srv/company-canvas/output
   
   # –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
   if [ ! -f /srv/company-canvas/sessions_metadata.json ]; then
       echo '[]' > /srv/company-canvas/sessions_metadata.json
   fi
   chmod 666 /srv/company-canvas/sessions_metadata.json
   ```

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ:**
   ```bash
   chmod +x deploy_vm.sh
   ./deploy_vm.sh v08h
   ```

3. **–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:**
   ```bash
   docker stop company-canvas-prod
   docker rm company-canvas-prod
   docker pull sergeykostichev/company-canvas-app:v08h
   
   docker run -d --restart unless-stopped -p 80:8000 \
     -e OPENAI_API_KEY="–≤–∞—à_–∫–ª—é—á" \
     -e SERPER_API_KEY="–≤–∞—à_–∫–ª—é—á" \
     -e SCRAPINGBEE_API_KEY="–≤–∞—à_–∫–ª—é—á" \
     -e HUBSPOT_API_KEY="–≤–∞—à_–∫–ª—é—á" \
     --name company-canvas-prod \
     -v /srv/company-canvas/output:/app/output \
     -v /srv/company-canvas/sessions_metadata.json:/app/sessions_metadata.json \
     sergeykostichev/company-canvas-app:v08h
   ```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker ps

# –õ–æ–≥–∏
docker logs -f company-canvas-prod

# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl http://localhost/api/sessions
curl http://localhost/api/criteria/sessions

# –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
# http://IP_–∞–¥—Ä–µ—Å_–≤–∞—à–µ–π_VM
```

## –í–µ—Ä—Å–∏–∏ –∏ –∏—Å—Ç–æ—Ä–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ü—Ä–æ–±–ª–µ–º—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ (v08e - v08g):
- **v08e**: –ø–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ - –ø—Ä–æ–±–ª–µ–º—ã —Å .dockerignore
- **v08f**: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π - –ø—Ä–æ–±–ª–µ–º—ã —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏  
- **v08g**: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤ - –ø—Ä–æ–±–ª–µ–º—ã —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- **v08h**: –ø–æ–ª–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ ‚úÖ

### –°–ª–µ–¥—É—é—â–∏–µ –≤–µ—Ä—Å–∏–∏:
- **v08i**: —Å–ª–µ–¥—É—é—â–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ v08h

### üîß –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞:
- ‚úÖ –£–±—Ä–∞–ª–∏ `output/` –∏ `sessions_metadata.json` –∏–∑ .dockerignore
- ‚úÖ –ó–∞–º–µ–Ω–∏–ª–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ –Ω–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ (`/app/output/sessions/`)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–∏–ª–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏–º–ø–æ—Ä—Ç–æ–≤ –º–æ–¥—É–ª–µ–π
- ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `sessions_metadata.json` –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–æ–º

### üêõ –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. **–ù–µ –≤–∏–¥–Ω—ã —Å–µ—Å—Å–∏–∏ –≤–æ 2-–π –≤–∫–ª–∞–¥–∫–µ** ‚Üí –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
2. **"File not found" –æ—à–∏–±–∫–∏** ‚Üí –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–±—Å–æ–ª—é—Ç–Ω—ã–º–∏ –ø—É—Ç—è–º–∏
3. **"cannot access local variable 'os'"** ‚Üí –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ—Ä—è–¥–∫–æ–º –∏–º–ø–æ—Ä—Ç–æ–≤
4. **–ü–æ—Ç–µ—Ä—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ** ‚Üí –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Ç–æ–º–æ–º

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ v08h

1. **Criteria Processor –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å**: –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
2. **Async –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 5-8x —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–º–ø–∞–Ω–∏–π
3. **–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ UTF-8, Cyrillic, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
4. **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –≤—Å–µ –ø—É—Ç–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ Docker
5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è**: –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

- `DEPLOY_INSTRUCTIONS.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å troubleshooting
- `deploy.ps1` - PowerShell —Å–∫—Ä–∏–ø—Ç –¥–ª—è Windows
- `deploy_vm.sh` - Bash —Å–∫—Ä–∏–ø—Ç –¥–ª—è VM
- `DEPLOY_SUMMARY.md` - —ç—Ç–∞ —Å–≤–æ–¥–∫–∞
- `docs/DEPLOYMENT_GUIDE.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
```bash
# –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω?
docker ps | grep company-canvas-prod

# –ï—Å—Ç—å –ª–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã?
docker exec company-canvas-prod ls -la /app/sessions_metadata.json

# –†–∞–±–æ—Ç–∞—é—Ç –ª–∏ API?
curl -s http://localhost/api/sessions | jq length
curl -s http://localhost/api/criteria/sessions | jq length
```

### –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
# –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
docker logs -f company-canvas-prod | grep -E "(ERROR|criteria|sessions|WARN)"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker exec company-canvas-prod find /app -name "*.json" -o -name "sessions"

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å —á–∏—Å—Ç—ã–º–∏ –ª–æ–≥–∞–º–∏
docker restart company-canvas-prod
``` 
# üõ°Ô∏è –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Circuit Breaker + State Manager –¥–ª—è OpenAI API Rate Limiting

## üìã **–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞**
–†–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤ OpenAI API –≤ –∫–æ–Ω—Ü–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (5-–π –ø—Ä–æ–¥—É–∫—Ç –ø—Ä–æ–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è) –ø—É—Ç–µ–º —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è.

---

## üîç **–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**

### **–§–∞–π–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è ‚úÖ (–∏–∑—É—á–µ–Ω—ã)**
- [x] `services/criteria_processor/src/external/openai_client.py` - –≥–ª–∞–≤–Ω—ã–π API –∫–ª–∏–µ–Ω—Ç (45 —Å—Ç—Ä–æ–∫)
- [x] `services/criteria_processor/src/core/parallel_processor.py` - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (515 —Å—Ç—Ä–æ–∫)
- [x] `services/criteria_processor/src/criteria/mandatory.py` - sync mandatory –ø—Ä–æ–≤–µ—Ä–∫–∏ (64 —Å—Ç—Ä–æ–∫–∏)
- [x] `services/criteria_processor/src/criteria/nth.py` - sync NTH –ø—Ä–æ–≤–µ—Ä–∫–∏ (68 —Å—Ç—Ä–æ–∫)
- [x] `services/criteria_processor/src/criteria/base.py` - –±–∞–∑–æ–≤—ã–µ OpenAI –∑–∞–ø—Ä–æ—Å—ã (35 —Å—Ç—Ä–æ–∫)
- [x] `services/criteria_processor/src/utils/config.py` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (183 —Å—Ç—Ä–æ–∫–∏)
- [x] `services/criteria_processor/src/data/savers.py` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (78 —Å—Ç—Ä–æ–∫)

### **OpenAI –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤:**
1. **`src/external/openai_client.py:9`** - —Ñ—É–Ω–∫—Ü–∏—è `get_openai_response()` 
2. **`src/criteria/base.py:19`** - —Ñ—É–Ω–∫—Ü–∏—è `get_structured_response()` (–≤—ã–∑—ã–≤–∞–µ—Ç openai_client)
3. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**
   - `src/criteria/mandatory.py:35` - –¥–ª—è mandatory –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤  
   - `src/criteria/nth.py:35` - –¥–ª—è NTH –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
   - `src/criteria/general.py:34` - –¥–ª—è general –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
   - `src/criteria/qualification.py:32` - –¥–ª—è qualification –≤–æ–ø—Ä–æ—Å–æ–≤

### **–¢–µ–∫—É—â–∏–π retry –º–µ—Ö–∞–Ω–∏–∑–º** (–≤ `openai_client.py:24-28`):
```python
if "rate_limit" in str(e).lower() and attempt < max_retries - 1:
    wait_time = (2 ** attempt) * 5  # 5, 10, 20 —Å–µ–∫—É–Ω–¥  
    time.sleep(wait_time)
    continue
```

### **–ü—Ä–æ–±–ª–µ–º–∞:**
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –¥–µ–ª–∞—é—Ç retry –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ ‚Üí –µ—â–µ –±–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏
- –ù–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏
- –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö

---

## üéØ **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

### **1. üõ°Ô∏è Global Circuit Breaker**
**–§–∞–π–ª:** `services/criteria_processor/src/utils/circuit_breaker.py` *(–Ω–æ–≤—ã–π)*

- [ ] **–ö–ª–∞—Å—Å `OpenAICircuitBreaker`:**
  - [ ] –°–æ—Å—Ç–æ—è–Ω–∏—è: `CLOSED`, `OPEN`, `HALF_OPEN`
  - [ ] –°—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ rate limit
  - [ ] –¢–∞–π–º–µ—Ä –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 2 –º–∏–Ω—É—Ç—ã)
  - [ ] Thread-safe –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏
  - [ ] –ú–µ—Ç–æ–¥ `can_execute()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–Ω–æ –ª–∏ –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å
  - [ ] –ú–µ—Ç–æ–¥ `record_success()` - –∑–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
  - [ ] –ú–µ—Ç–æ–¥ `record_failure()` - –∑–∞–ø–∏—Å—å –æ—à–∏–±–∫–∏ + –≤–æ–∑–º–æ–∂–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ circuit
  - [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏–π

### **2. üíæ Progress State Manager** 
**–§–∞–π–ª:** `services/criteria_processor/src/utils/state_manager.py` *(–Ω–æ–≤—ã–π)*

- [ ] **–ö–ª–∞—Å—Å `ProcessingStateManager`:**
  - [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è: `{product_index, company_index, audience, stage}`
  - [ ] –§–æ—Ä–º–∞—Ç JSON —Ñ–∞–π–ª–∞: `session_id_progress.json` –≤ –ø–∞–ø–∫–µ `output/session_id/`
  - [ ] –ú–µ—Ç–æ–¥—ã:
    - [ ] `save_progress(product_idx, company_idx, audience, stage)` 
    - [ ] `load_progress()` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    - [ ] `clear_progress()` - –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
    - [ ] `save_partial_results(results)` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    - [ ] `load_partial_results()` - –∑–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### **3. üîß Enhanced OpenAI Client**
**–§–∞–π–ª:** `services/criteria_processor/src/external/openai_client.py` *(–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)*

- [ ] **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Circuit Breaker:**
  - [ ] –ò–º–ø–æ—Ä—Ç `OpenAICircuitBreaker` 
  - [ ] –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç–∞–Ω—Å breaker: `_circuit_breaker = OpenAICircuitBreaker()`
  - [ ] –°—Ç—Ä–æ–∫–∞ ~10: –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `if not _circuit_breaker.can_execute(): raise CircuitOpenException`
  - [ ] –°—Ç—Ä–æ–∫–∞ ~24: –∑–∞–º–µ–Ω–∏—Ç—å –ø—Ä–æ—Å—Ç—É—é –ø—Ä–æ–≤–µ—Ä–∫—É rate limit –Ω–∞ `_circuit_breaker.record_failure(e)`
  - [ ] –°—Ç—Ä–æ–∫–∞ ~35: –¥–æ–±–∞–≤–∏—Ç—å `_circuit_breaker.record_success()` –ø—Ä–∏ —É—Å–ø–µ—Ö–µ
  - [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É `CircuitOpenException` —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

### **4. üîÑ Resilient Parallel Processor** 
**–§–∞–π–ª:** `services/criteria_processor/src/core/parallel_processor.py` *(–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)*

#### **–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ `run_parallel_analysis()` (—Å—Ç—Ä–æ–∫–∞ 417):**
- [ ] **–î–æ–±–∞–≤–∏—Ç—å State Manager:**
  - [ ] –°—Ç—Ä–æ–∫–∞ ~430: —Å–æ–∑–¥–∞—Ç—å `state_manager = ProcessingStateManager(session_id)`
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `state_manager.load_progress()`
  - [ ] –ï—Å–ª–∏ –µ—Å—Ç—å ‚Üí –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –º–µ—Å—Ç–∞
  - [ ] –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –Ω–∞—á–∞—Ç—å —Å –Ω–∞—á–∞–ª–∞

- [ ] **–û–±–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (—Å—Ç—Ä–æ–∫–∞ ~480):**
  - [ ] –î–æ–±–∞–≤–∏—Ç—å try/except –≤–æ–∫—Ä—É–≥ —Ü–∏–∫–ª–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
  - [ ] –ü—Ä–∏ `CircuitOpenException` –∏–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤:
    - [ ] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å: `state_manager.save_progress(product_idx, 0, None, "paused")`
    - [ ] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–∞—Å—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: `state_manager.save_partial_results(all_results)`
    - [ ] –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–∞—É–∑—É –∏ –≤—Ä–µ–º—è –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    - [ ] –ñ–¥–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è circuit breaker –∏–ª–∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å —á–∞—Å—Ç–∏—á–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

#### **–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ `process_single_company_for_product()` (—Å—Ç—Ä–æ–∫–∞ 32):**
- [ ] **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å-—Ç—Ä–µ–∫–∏–Ω–≥:**
  - [ ] –ü–∞—Ä–∞–º–µ—Ç—Ä: –¥–æ–±–∞–≤–∏—Ç—å `progress_callback=None`
  - [ ] –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π successful –∫–æ–º–ø–∞–Ω–∏–∏: –≤—ã–∑—ã–≤–∞—Ç—å `progress_callback(company_name, product, "completed")`
  - [ ] –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö: –≤—ã–∑—ã–≤–∞—Ç—å `progress_callback(company_name, product, "failed", error)`

#### **–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤:**
- [ ] **`check_mandatory_criteria_batch()` (—Å—Ç—Ä–æ–∫–∞ 243):**
  - [ ] –û–±–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ OpenAI –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ try/except –¥–ª—è `CircuitOpenException`
  - [ ] –ü—Ä–∏ circuit open ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç "CIRCUIT_OPEN" 
  - [ ] –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ circuit breaker

- [ ] **`check_nth_criteria_batch()` (—Å—Ç—Ä–æ–∫–∞ 322):**
  - [ ] –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–∞–∫ –≤ mandatory
  - [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è circuit breaker

### **5. üìä Recovery & Resume Logic**
**–§–∞–π–ª:** `services/criteria_processor/src/core/recovery.py` *(–Ω–æ–≤—ã–π)*

- [ ] **–§—É–Ω–∫—Ü–∏—è `resume_processing(session_id)`:**
  - [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  - [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —á–∞—Å—Ç–∏—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤  
  - [ ] –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –º–µ—Å—Ç–∞
  - [ ] –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∏ –Ω–æ–≤—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

- [ ] **–§—É–Ω–∫—Ü–∏—è `validate_partial_results(results)`:**
  - [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
  - [ ] –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
  - [ ] –û—Ç—á–µ—Ç –æ —Å—Ç–∞—Ç—É—Å–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### **6. ‚öôÔ∏è Configuration Updates**
**–§–∞–π–ª:** `services/criteria_processor/src/utils/config.py` *(–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)*

- [ ] **–î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é CIRCUIT_BREAKER_CONFIG (—Å—Ç—Ä–æ–∫–∞ ~180):**
  ```python
  CIRCUIT_BREAKER_CONFIG = {
      'failure_threshold': 5,           # –û—à–∏–±–æ–∫ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è circuit
      'recovery_timeout': 120,          # –°–µ–∫—É–Ω–¥ –¥–æ –ø–æ–ø—ã—Ç–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è  
      'success_threshold': 3,           # –£—Å–ø–µ—Ö–æ–≤ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è circuit
      'rate_limit_keywords': ['rate_limit', 'quota_exceeded', 'too_many_requests'],
      'enable_circuit_breaker': True    # –ú–∞—Å—Ç–µ—Ä-–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
  }
  ```

### **7. üñ•Ô∏è CLI Integration**
**–§–∞–π–ª:** `services/criteria_processor/main.py` *(–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)*

- [ ] **–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:**
  - [ ] `--resume-session SESSION_ID` - –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—Ä–µ—Ä–≤–∞–Ω–Ω—É—é —Å–µ—Å—Å–∏—é
  - [ ] `--circuit-breaker-enabled` - –≤–∫–ª—é—á–∏—Ç—å circuit breaker (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é True)
  - [ ] `--max-rate-limit-failures N` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–∞

- [ ] **–õ–æ–≥–∏–∫–∞ –∑–∞–ø—É—Å–∫–∞:**
  - [ ] –ü—Ä–∏ `--resume-session`: –≤—ã–∑–≤–∞—Ç—å `resume_processing(session_id)`
  - [ ] –ò–Ω–∞—á–µ: –æ–±—ã—á–Ω—ã–π `run_parallel_analysis()`

---

## üìÖ **–ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–ø–æ—ç—Ç–∞–ø–Ω–æ)**

### **–§–∞–∑–∞ 1: Core Infrastructure** 
- [ ] –°–æ–∑–¥–∞—Ç—å `circuit_breaker.py` —Å –∫–ª–∞—Å—Å–æ–º `OpenAICircuitBreaker`
- [ ] –°–æ–∑–¥–∞—Ç—å `state_manager.py` —Å –∫–ª–∞—Å—Å–æ–º `ProcessingStateManager`  
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `config.py`
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### **–§–∞–∑–∞ 2: OpenAI Client Integration**
- [ ] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `openai_client.py` –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å circuit breaker
- [ ] –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–æ—Å—Ç—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

### **–§–∞–∑–∞ 3: Parallel Processor Integration** 
- [ ] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `run_parallel_analysis()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è state manager
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å-—Ç—Ä–µ–∫–∏–Ω–≥ –≤ `process_single_company_for_product()`
- [ ] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å batch —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è circuit breaker
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–º–ø–∞–Ω–∏—è–º–∏

### **–§–∞–∑–∞ 4: Recovery & CLI**
- [ ] –°–æ–∑–¥–∞—Ç—å `recovery.py` —Å –ª–æ–≥–∏–∫–æ–π –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å CLI –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `main.py`
- [ ] –ü–æ–ª–Ω–æ–µ end-to-end —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–§–∞–∑–∞ 5: Testing & Documentation**
- [ ] –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è rate limiting —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- [ ] –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

---

## üö® **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏ –≤–Ω–∏–º–∞–Ω–∏—è**

### **Thread Safety:**
- Circuit breaker –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å thread-safe –¥–ª—è `ThreadPoolExecutor`
- State manager –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å file locking –ø—Ä–∏ –∑–∞–ø–∏—Å–∏

### **Error Handling:**
- –†–∞–∑–¥–µ–ª—è—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ (network) –æ—Ç rate limit
- Graceful degradation –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ state manager

### **Performance:**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead –Ω–∞ –∫–∞–∂–¥—ã–π OpenAI –∑–∞–ø—Ä–æ—Å
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–Ω–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞)

### **Data Integrity:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏
- –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ resume

---

## ‚úÖ **–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**

1. **Rate Limiting Management:** Circuit breaker –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç cascade failures
2. **State Persistence:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å –ª—é–±–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞
3. **No Data Loss:** –í—Å–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è 
4. **Performance:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
5. **Reliability:** –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö

---

## üéØ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- ‚úÖ –ù–µ—Ç cascade failures –ø—Ä–∏ rate limiting
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–∞—É–∑  
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ—è—Ö
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö 5 –ø—Ä–æ–¥—É–∫—Ç–æ–≤

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 3-4 —á–∞—Å–∞ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è-–≤—ã—Å–æ–∫–∞—è (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ state management) 
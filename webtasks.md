# План реализации Веб-интерфейса с FastAPI и Сессиями

## Фаза 1: Подготовка и Настройка Backend (FastAPI)

1.  [x] **Настройка Структуры Проекта:**
    *   [x] Создать корневую папку проекта (она уже есть: `company-description`).
    *   [x] Внутри создать папки `backend/` и `frontend/`.
    *   [x] Убедиться, что существующая папка `src/` находится в корне проекта.
    *   [x] Файлы `.env`, `llm_config.yaml`, `sessions_metadata.json`, `requirements.txt`, `README.md` оставить в корневой папке.
    *   [x] Обновить `requirements.txt`, добавив `fastapi`, `uvicorn[standard]`, `python-multipart`, `aiofiles` (и удалить `tkinter`, если CLI больше не нужен).
2.  [x] **Инициализация Базового FastAPI Приложения:**
    *   [x] Создать `backend/main.py`.
    *   [x] Настроить базовое приложение FastAPI: `app = FastAPI()`.
    *   [x] Добавить `.gitignore`, если его нет, включив `.env`, `venv/`, `__pycache__/`, `output/sessions/*`.
3.  [x] **Интеграция Логики Сессий в Backend:**
    *   [x] В `backend/main.py` импортировать функции из `src.data_io`.
    *   [x] Скорректировать пути к `SESSIONS_DIR` и `SESSIONS_METADATA_FILE` для корректной работы из `backend/main.py`.
4.  [x] **Создание Основных API Эндпоинтов для Сессий:**
    *   [x] `GET /api/sessions`: Реализовать эндпоинт для получения списка сессий.
    *   [x] `GET /api/sessions/{session_id}`: Реализовать эндпоинт для получения данных конкретной сессии.
5.  [x] **Реализация Эндпоинта "Новая Сессия":**
    *   [x] `POST /api/sessions`: Принимать файл (`UploadFile`) и контекст (`Form`).
    *   [x] Генерировать `session_id`.
    *   [x] Создавать папку сессии.
    *   [x] Асинхронно сохранять файл и контекст.
    *   [x] Создавать запись в `sessions_metadata.json` (статус `created`).
    *   [x] Возвращать метаданные сессии.
6.  [x] **Настройка Запуска Фоновых Задач:**
    *   [x] Использовать `BackgroundTasks`.
    *   [x] Создать функцию-обертку (`backend/processing_runner.py`) для запуска `run_pipeline_for_file`.
    *   [x] Обертка должна обновлять статус сессии, настраивать логирование, выполнять `run_pipeline_for_file`, обновлять финальный статус.
7.  [x] **Реализация Эндпоинта "Запуск Обработки":**
    *   [x] `POST /api/sessions/{session_id}/start`: Проверять статус, получать пути, загружать конфиги, добавлять задачу в `BackgroundTasks`, возвращать немедленный ответ.

## Фаза 2: Базовая Реализация Frontend

8.  [x] **Создание Базовой HTML-структуры:**
    *   [x] Создать `frontend/index.html` с основными элементами (выбор сессии, кнопка New, секция New, кнопка Start, статус, таблица, кнопки/ссылки для файлов).
9.  [x] **Реализация Базовой Frontend Логики (JS):**
    *   [x] Создать `frontend/app.js`.
    *   [x] Реализовать загрузку списка сессий (`fetch /api/sessions`).
    *   [x] Реализовать загрузку данных и результатов выбранной сессии (`fetch /api/sessions/{id}` и `fetch /api/sessions/{id}/results`).
    *   [x] Реализовать отображение/скрытие секции "New Session".
    *   [x] Реализовать отправку данных для создания новой сессии (`POST /api/sessions` с `FormData`).
    *   [x] Реализовать запуск обработки (`POST /api/sessions/{id}/start`).
    *   [x] Реализовать опрос статуса (`setInterval`, `fetch /api/sessions/{id}`) и обновление/загрузку результатов по завершении.
    *   [x] Реализовать функцию отображения результатов в таблице.

## Фаза 3: Улучшения и Завершение

10. [x] **Реализация Эндпоинтов для Результатов и Логов:**
    *   [x] `GET /api/sessions/{session_id}/results`: Читать CSV, конвертировать в JSON, возвращать.
    *   [x] `GET /api/sessions/{session_id}/logs/{log_type}`: Читать лог-файл, возвращать.
11. [x] **Улучшение Обработки Ошибок и UI:**
    *   [x] Добавить валидацию и обработку ошибок на бэкенде.
    *   [x] Улучшить сообщения об ошибках на фронтенде.
    *   [x] Добавить индикаторы загрузки.
12. [ ] **Подготовка к Развертыванию (Deployment):**
    *   [ ] Создать `Dockerfile` для бэкенда.
    *   [ ] Настроить Nginx (или другой веб-сервер).
    *   [ ] Написать инструкции.
13. [ ] **Обновление Документации (`README.md`):**
    *   [ ] Описать новую архитектуру.
    *   [ ] Добавить инструкции по запуску/развертыванию.
    *   [ ] Описать API. 
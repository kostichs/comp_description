# 🚀 Система анализа критериев компаний v2.0

## 📋 Новая модульная архитектура

Полностью рефакторенная система с чистой архитектурой и разделением ответственности.

## 🏗️ Структура проекта

```
📁 Проект/
├── 📁 src/                    # Основной код системы
│   ├── 📁 core/               # Бизнес-логика
│   │   └── processor.py       # Главный процессор анализа
│   ├── 📁 criteria/           # Модули проверки критериев
│   │   ├── base.py           # Базовые функции
│   │   ├── general.py        # General критерии
│   │   ├── qualification.py  # Qualification критерии
│   │   ├── mandatory.py      # Mandatory критерии
│   │   └── nth.py           # NTH критерии
│   ├── 📁 data/              # Работа с данными
│   │   ├── loaders.py        # Загрузка данных
│   │   ├── encodings.py      # Работа с кодировками
│   │   └── savers.py         # Сохранение результатов
│   ├── 📁 external/          # Внешние API
│   │   ├── serper.py         # Serper.dev API
│   │   └── openai_client.py  # OpenAI API
│   ├── 📁 formatters/        # Форматирование выводов
│   │   ├── json_format.py    # JSON форматирование
│   │   └── csv_format.py     # CSV форматирование
│   ├── 📁 utils/             # Утилиты
│   │   ├── config.py         # Конфигурация
│   │   ├── logging.py        # Логирование
│   │   └── models.py         # Модели данных
│   └── 📁 filters/           # Фильтры (будущее)
├── 📁 tests/                 # Тесты
├── 📁 config/                # Конфигурационные файлы
│   ├── prompts.yaml          # Промпты для OpenAI
│   └── settings.py           # Центральные настройки
├── 📁 data/                  # Входные данные
├── 📁 criteria/              # Файлы критериев
├── 📁 output/                # Результаты анализа
├── 📁 logs/                  # Логи
└── 📁 scripts/               # Вспомогательные скрипты
```

## 🎯 Ключевые улучшения

### ✅ Решенные проблемы
- **Все файлы <200 строк** - разбиты большие модули
- **Четкое разделение ответственности** - каждый модуль отвечает за свою область
- **Модульная архитектура** - легко тестировать и расширять
- **Чистые импорты** - нет циклических зависимостей
- **Логическая структура папок** - интуитивно понятная организация

### 🔧 Архитектурные принципы
- **Single Responsibility** - один модуль = одна задача
- **Dependency Injection** - зависимости передаются явно
- **Clean Architecture** - бизнес-логика отделена от внешних API
- **Testability** - каждый модуль можно тестировать независимо

## 🚀 Запуск системы

### Новая система (рекомендуется)
```bash
python main_new.py
```

### Тестирование архитектуры
```bash
python test_new_architecture.py
```

### Старая система (для сравнения)
```bash
python main.py
```

## 📊 Статистика рефакторинга

### До рефакторинга
- 17 файлов в корне проекта
- 4 файла >200 строк
- Смешанная бизнес-логика
- Сложные зависимости

### После рефакторинга
- Модульная структура src/
- Все файлы <200 строк
- Четкое разделение ответственности
- Простые и понятные зависимости

## 🧪 Тестирование

Система включает автоматические тесты:
- ✅ Тестирование импортов всех модулей
- ✅ Валидация конфигурации
- ✅ Проверка загрузки данных
- ✅ Интеграционные тесты

## 📈 Производительность

Новая архитектура обеспечивает:
- **Быстрый запуск** - оптимизированные импорты
- **Эффективная память** - модульная загрузка
- **Параллельная обработка** - готовность к масштабированию

## 🔄 Миграция

### Совместимость
- ✅ Полная совместимость с существующими данными
- ✅ Те же результаты анализа
- ✅ Тот же формат выходных файлов
- ✅ Те же API ключи и настройки

### Переход
1. Используйте `main_new.py` вместо `main.py`
2. Все остальное работает без изменений
3. Старая система остается доступной для сравнения

## 🛠️ Разработка

### Добавление новых критериев
1. Создайте модуль в `src/criteria/`
2. Наследуйтесь от базовых функций в `base.py`
3. Добавьте импорт в `processor.py`

### Добавление новых форматов вывода
1. Создайте модуль в `src/formatters/`
2. Реализуйте нужные функции форматирования
3. Интегрируйте в `savers.py`

### Добавление новых внешних API
1. Создайте модуль в `src/external/`
2. Реализуйте клиент API
3. Добавьте конфигурацию в `config.py`

## 📝 Логирование

Улучшенная система логирования:
- Структурированные логи
- Разные уровни детализации
- Автоматическое создание файлов логов
- Цветной вывод в консоль

## 🔧 Конфигурация

Централизованная конфигурация:
- `src/utils/config.py` - основные настройки
- `config/settings.py` - дополнительные параметры
- `.env` - секретные ключи API
- `config/prompts.yaml` - промпты для OpenAI

## 🎉 Результат

Новая архитектура обеспечивает:
- **Maintainability** - легко поддерживать и развивать
- **Scalability** - готовность к росту функциональности
- **Testability** - полное покрытие тестами
- **Performance** - оптимизированная работа
- **Developer Experience** - приятная разработка

---

**Система готова к использованию!** 🚀 